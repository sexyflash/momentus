<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>시간 낭비 없는 쇼핑</title>
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-T8Y89D206F"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-T8Y89D206F');
    </script>
    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Pretendard', sans-serif;
        }
        .site {
            width: 100%;
            max-width: 1920px;
            margin: 0 auto;
            position: relative;
        }
        .gnb {
            width: 100%;
            max-width: 1920px;
            height: 70px;
            background: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            position: fixed;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .logo {
            height: 12px;
        }
        .nav-menu {
            display: flex;
            gap: 2rem;
            align-items: center;
        }
        .nav-item {
            font-size: 16px;
            color: #191C23;
            text-decoration: none;
        }
        .contact-btn {
            background: #1937F5;
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: 600;
        }
        .hero {
            padding-top: 200px;
            text-align: center;
        }
        .hero-title {
            font-size: 48px;
            font-weight: 700;
            color: #191C23;
            margin-bottom: 40px;
            line-height: 1.3;
        }
        .buttons {
            display: inline-flex;
            justify-content: center;
            align-items: flex-start;
            gap: 20px;
            margin-top: 200px;
        }
        .button {
            display: flex;
            align-items: center;
            gap: 16px;
            border: none;
            background: white;
            cursor: pointer;
            text-decoration: none;
        }
        .button-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        .youtube-link {
            font-size: 16px;
            color: #191C23;
            text-decoration: none;
            cursor: pointer;
        }
        .preview {
            max-width: 100%;
            margin: 0 auto;
            padding: 20px;
            text-align: center;
        }
        .preview img {
            max-width: 100%;
            height: auto;
        }
        .pc-only {
            display: flex;
        }
        .bookmark-btn {
            padding: 12px 24px;
            background: #1937F5;
            color: white;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            margin-top: 20px;
            display: inline-block;
        }
        @media (max-width: 768px) {
            .nav-menu {
                display: none;
            }
            .hero-title {
                font-size: 24px;
                padding: 0 20px;
            }
            .hero-title br {
                display: none;
            }
            .buttons {
                margin-top: 40px;
                flex-direction: column;
                align-items: center;
            }
            .bookmark-container {
                margin-top: 30px;
            }
        }
    </style>
</head>
<body>
    <div class="site">
        <nav class="gnb">
            <img src="assets/svg-common_watermark_logo.svg" alt="Logo" class="logo">
            <div class="nav-menu">
                <a href="https://search.shopping.naver.com/ns/search?query=%EB%AA%A8%EB%A9%98%ED%84%B0%EC%8A%A4%20%EA%B5%BF%EB%85%B8%ED%8A%B8&prevQuery=%EB%AA%A8%EB%A9%98%ED%84%B0%EC%8A%A4%20pdf" target="_blank" class="nav-item">굿노트 플래너</a>
                <a href="https://apps.apple.com/kr/app/%ED%8F%AC%EB%AA%A8%EB%8F%84%EB%A1%9C-%ED%83%80%EC%9D%B4%EB%A8%B8-%EC%83%9D%EC%82%B0%EC%84%B1-%EC%A7%91%EC%A4%91-%EA%B4%80%EB%A6%AC/id6736511638?mt=12" target="_blank" class="nav-item">뽀모도로 타이머</a>
                <a href="https://chromewebstore.google.com/detail/chatpage-ai-%EC%BD%98%ED%85%90%EC%B8%A0-%EC%9A%94%EC%95%BD/mcecffeookkllgkbflcdlbicolmfgifj?authuser=0&hl=ko" target="_blank" class="nav-item">챗GPT 익스텐션</a>
                <a href="mailto:sexyflash+qqp@gmail.com" class="nav-item contact-btn">문의하기</a>
            </div>
        </nav>
        <section class="hero">
            <h1 class="hero-title">시간 낭비 없는 쇼핑,<br>이 비법으로 시작하세요!</h1>
            
            <div class="buttons pc-only">
                <a href="https://www.coupang.com/np/search?q=%EB%B2%A0%EB%9F%B4%20%EC%97%AC%EC%95%84%20%EC%88%98%EC%98%81%EB%B3%B5&channel=recent" class="button" target="_blank">
                    <img src="assets/png-button_1.png" alt="테스트하기" height="120">
                </a>
                <div class="button-wrapper">
                    <a href="javascript:(function()%7Bif(window.optionInfoScriptExecuted)%20return%3Bwindow.optionInfoScriptExecuted%3Dtrue%3Bconst%20ProductModel%3D%7Bproducts%3A%5B%5D%2CaddProduct%3Afunction(product)%7Bthis.products.push(product)%3B%7D%2CgetProductByTitle%3Afunction(title)%7Breturn%20this.products.find(function(product)%7Breturn%20product.title%3D%3D%3Dtitle%3B%7D)%3B%7D%7D%3Bconst%20ProductView%3D%7BaddStyle%3Afunction()%7Bconst%20style%3Ddocument.createElement(%22style%22)%3Bstyle.textContent%3D%22.option-info%20%7Bbackground-color%3A%20%23f0f0f0%3Bborder%3A%201px%20solid%20%23ddd%3Bborder-radius%3A%204px%3Bpadding%3A%205px%3Bmargin-top%3A%2010px%3Bfont-size%3A%2012px%3Bcolor%3A%20%23333%3Bdisplay%3A%20block%20!important%3Bmin-height%3A%20100px%3Boverflow-y%3A%20auto%3B%7D%20.option-info-title%20%7Bfont-weight%3A%20bold%3Bmargin-bottom%3A%203px%3B%7D%20.option-info-content%20%7Bdisplay%3A%20flex%3Bflex-wrap%3A%20wrap%3Bgap%3A%205px%3B%7D%20.option-item%20%7Bpadding%3A%202px%205px%3Bborder-radius%3A%203px%3Bbackground-color%3A%20%230070C9%3Bcolor%3A%20white%3Bfont-weight%3A%20bold%3B%7D%20.option-item.unavailable%20%7Bbackground-color%3A%20%23999%3Bcolor%3A%20%23ddd%3B%7D%20.prod-option__selected.single%20%7Bcolor%3A%20%230070C9%3Bbackground-color%3A%20%23E5F1FC%3Bcursor%3A%20pointer%3B%7D%20.recommend-widget__list%20ul%20%7Bflex%3A%201%201%2025%25%3Bbox-sizing%3A%20border-box%3B%7D%20.search-product%20a%20%7Bheight%3A%20100%25%20!important%3B%7D%20%23productList%20%7Bdisplay%3A%20flex%3Bflex-wrap%3A%20wrap%3B%7D%20%23productList%20li%20%7Bflex%3A%201%201%2025%25%3Bbox-sizing%3A%20border-box%3B%7D%22%3Bdocument.head.appendChild(style)%3B%7D%2CcreateOptionInfoElement%3Afunction(options%2CjsonData)%7Bconst%20optionInfo%3Ddocument.createElement(%22div%22)%3BoptionInfo.className%3D%22option-info%22%3Blet%20innerHTML%3D%27%3Cdiv%20class%3D%22option-info-title%22%3E%EC%98%B5%EC%85%98%3A%3C%2Fdiv%3E%3Cdiv%20class%3D%22option-info-content%22%3E%27%3Bif(jsonData%20%26%26%20jsonData.options)%7Bconst%20optionRows%3DjsonData.options.optionRows%3Bconst%20attributeVendorItemMap%3DjsonData.options.attributeVendorItemMap%3Bif(optionRows.length%3D%3D%3D1)%7BoptionRows%5B0%5D.attributes.forEach(function(attr)%7Bconst%20isAvailable%3Dthis.checkAvailability(attributeVendorItemMap%2C%5Battr.valueId%5D)%3BinnerHTML%2B%3D%27%3Cspan%20class%3D%22option-item%20%27%20%2B%20(isAvailable%20%3F%20%27%27%20%3A%20%27unavailable%27)%20%2B%20%27%22%3E%27%20%2B%20attr.name%20%2B%20%27%3C%2Fspan%3E%27%3B%7D.bind(this))%3B%7D%20else%20if(optionRows.length%3E1)%7Blet%20combinations%3Dthis.generateCombinations(optionRows)%3Bcombinations.forEach(function(combo)%7Bconst%20isAvailable%3Dthis.checkAvailability(attributeVendorItemMap%2Ccombo.valueIds)%3BinnerHTML%2B%3D%27%3Cspan%20class%3D%22option-item%20%27%20%2B%20(isAvailable%20%3F%20%27%27%20%3A%20%27unavailable%27)%20%2B%20%27%22%3E%27%20%2B%20combo.name%20%2B%20%27%3C%2Fspan%3E%27%3B%7D.bind(this))%3B%7D%7D%20else%20if(options%20%26%26%20options.length%3E0)%7Boptions.forEach(function(option)%7BinnerHTML%2B%3D%27%3Cspan%20class%3D%22option-item%20%27%20%2B%20(option.available%20%3F%20%27%27%20%3A%20%27unavailable%27)%20%2B%20%27%22%3E%27%20%2B%20option.name%20%2B%20%27%3C%2Fspan%3E%27%3B%7D)%3B%7D%20else%7BinnerHTML%2B%3D%27%3Cp%3E%EC%98%B5%EC%85%98%20%EC%97%86%EC%9D%8C%20(%EB%8B%A8%EC%9D%BC%20%EC%83%81%ED%92%88)%3C%2Fp%3E%27%3B%7DinnerHTML%2B%3D%27%3C%2Fdiv%3E%27%3BoptionInfo.innerHTML%3DinnerHTML%3Breturn%20optionInfo%3B%7D%2CgenerateCombinations%3Afunction(optionRows)%7Blet%20result%3D%5B%7Bname%3A%22%22%2CvalueIds%3A%5B%5D%7D%5D%3BoptionRows.forEach(function(row)%7Blet%20newResult%3D%5B%5D%3Brow.attributes.forEach(function(attr)%7Bresult.forEach(function(prevCombo)%7BnewResult.push(%7Bname%3A(prevCombo.name%20%3F%20prevCombo.name%20%2B%20%22%20%22%20%3A%20%22%22)%20%2B%20attr.name%2CvalueIds%3AprevCombo.valueIds.concat(%5Battr.valueId%5D)%7D)%3B%7D)%3B%7D)%3Bresult%3DnewResult%3B%7D)%3Breturn%20result%3B%7D%2CcheckAvailability%3Afunction(attributeVendorItemMap%2CvalueIds)%7Bconst%20key%3DvalueIds.join(%22%3A%22)%3Bconst%20itemData%3DattributeVendorItemMap%5Bkey%5D%3Breturn%20itemData%20%3F%20!itemData.soldOut%20%3A%20false%3B%7D%2CrenderOptionInfo%3Afunction(product%2CproductElement)%7Bif(productElement%20%26%26%20!productElement.querySelector(%22.option-info%22))%7Bconst%20optionInfoElement%3Dthis.createOptionInfoElement(product.options%2Cproduct.jsonData)%3Bconst%20lastChild%3DproductElement.lastElementChild%3Bif(lastChild%20%26%26%20lastChild.tagName.toLowerCase()%3D%3D%3D%22a%22)%7BlastChild.appendChild(optionInfoElement)%3B%7D%20else%20%7BproductElement.appendChild(optionInfoElement)%3B%7D%7D%7D%2CaddOptionToTitle%3Afunction(product)%7Bconst%20titleElement%3Dproduct.element.querySelector(%22.recommend-widget__item__title%2C%20%5Bclass*%3D%5C%22name%5C%22%5D%2C%20%5Bclass*%3D%5C%22title%5C%22%5D%22)%3Bif(titleElement%20%26%26%20product.options)%7Bconst%20optionText%3Dproduct.options.map(function(opt)%7Breturn%20opt.name%3B%7D).join(%22%2C%20%22)%3BtitleElement.setAttribute(%22title%22%2C%20titleElement.textContent%20%2B%20%22%20(%22%20%2B%20optionText%20%2B%20%22)%22)%3B%7D%7D%2CrenderDefaultOptionInfo%3Afunction(product)%7Bconst%20optionInfo%3Ddocument.createElement(%22div%22)%3BoptionInfo.className%3D%22option-info%22%3BoptionInfo.innerHTML%3D%27%3Cp%3E%EC%98%B5%EC%85%98%20%EC%A0%95%EB%B3%B4%EB%A5%BC%20%EB%B6%88%EB%9F%AC%EC%98%A4%EC%A7%80%20%EC%88%98%20%EC%97%86%EC%8A%B5%EB%8B%88%EB%8B%A4.%3C%2Fp%3E%27%3Bproduct.element.appendChild(optionInfo)%3B%7D%7D%3Bconst%20ProductController%3D%7Binit%3Afunction()%7BProductView.addStyle()%3Bthis.loadProducts()%3Bthis.processProducts()%3B%7D%2CloadProducts%3Afunction()%7Bconst%20productElements%3Dthis.findProductElements()%3BproductElements.forEach(function(element)%7Bconst%20titleElement%3Delement.querySelector(%22%5Bclass*%3D%5C%22name%5C%22%5D%2C%20%5Bclass*%3D%5C%22title%5C%22%5D%22)%3Bif(titleElement)%7Bconst%20title%3DtitleElement.textContent.trim()%3Bconst%20productId%3Dthis.extractProductId(element)%3Bif(productId)%7BProductModel.addProduct(%7Btitle%3Atitle%2Cid%3AproductId%2Celement%3Aelement%7D)%3B%7D%7D%7D.bind(this))%3B%7D%2CfindProductElements%3Afunction()%7Bconst%20productSelectors%3D%5B%22.search-product%22%2C%22.baby-product%22%2C%22%5Bclass*%3D%5C%22product-item%5C%22%5D%22%2C%22%5Bclass*%3D%5C%22product_item%5C%22%5D%22%2C%22%5Bclass*%3D%5C%22productItem%5C%22%5D%22%2C%22%5Bdata-product-id%5D%22%2C%22%5Bdata-productid%5D%22%2C%22.cmg-dco-carousel-item%22%2C%22.recommend-widget__list%20ul%20%3E%20li%22%5D%3Bconst%20allProducts%3Dnew%20Set()%3BproductSelectors.forEach(function(selector)%7Bdocument.querySelectorAll(selector).forEach(function(element)%7Bif(!element.closest(%22%23my-view%22)%20%26%26%20this.extractProductId(element))%7BallProducts.add(element)%3B%7D%7D.bind(this))%3B%7D.bind(this))%3Breturn%20Array.from(allProducts)%3B%7D%2CextractProductId%3Afunction(element)%7Blet%20productId%3Delement.getAttribute(%22data-product-id%22)%20%7C%7C%20element.getAttribute(%22data-productid%22)%3Bif(!productId)%7Bconst%20link%3Delement.querySelector(%22a%5Bhref*%3D%5C%22%2Fproducts%2F%5C%22%5D%22)%3Bif(link)%7Bconst%20match%3Dlink.href.match(%2F%5C%2Fproducts%5C%2F(%5Cd%2B)%2F)%3Bif(match)%7BproductId%3Dmatch%5B1%5D%3B%7D%7D%7Dreturn%20productId%3B%7D%2CprocessProducts%3Afunction()%7BProductModel.products.forEach(function(product)%7Bthis.fetchOptions(product.id).then(function(data)%7Bproduct.options%3Ddata.options%3Bproduct.jsonData%3Ddata.jsonData%3BProductView.renderOptionInfo(product%2Cproduct.element)%3BProductView.addOptionToTitle(product)%3B%7D.bind(this)).catch(function(error)%7Bconsole.error(%22Error%20processing%20product%3A%22%2C%20product.title%2C%20error)%3BProductView.renderDefaultOptionInfo(product)%3B%7D)%3B%7D.bind(this))%3B%7D%2CfetchOptions%3Afunction(productId)%7Breturn%20fetch(%22https%3A%2F%2Fwww.coupang.com%2Fvp%2Fproducts%2F%22%20%2B%20productId).then(function(response)%7Breturn%20response.text()%3B%7D).then(function(html)%7Bconst%20parser%3Dnew%20DOMParser()%3Bconst%20doc%3Dparser.parseFromString(html%2C%20%22text%2Fhtml%22)%3Blet%20jsonData%3Dnull%3Blet%20options%3D%5B%5D%3Bconst%20scripts%3Ddoc.querySelectorAll(%22script%22)%3Bfor(let%20script%20of%20scripts)%7Bif(script.textContent.includes(%22exports.sdp%20%3D%22))%7Bconst%20jsonStr%3Dscript.textContent.split(%22exports.sdp%20%3D%22)%5B1%5D.split(%22%3B%22)%5B0%5D%3Btry%7BjsonData%3DJSON.parse(jsonStr)%3Bif(jsonData.options%20%26%26%20jsonData.options.optionRows)%7Boptions%3Dthis.extractOptionsFromJsonData(jsonData)%3B%7D%7Dcatch(error)%7Bconsole.error(%22Error%20parsing%20JSON%3A%22%2C%20error)%3B%7Dbreak%3B%7D%7Dif(options.length%3D%3D%3D0)%7Bconst%20optionElements%3Ddoc.querySelectorAll(%22.prod-option__selected%22)%3Boptions%3DArray.from(optionElements).map(function(el)%7Breturn%20%7Bname%3A%20el.querySelector(%22.value%22).textContent.trim()%2Cavailable%3A%20true%2CisSingle%3A%20el.classList.contains(%22single%22)%7D%3B%7D)%3B%7Dreturn%20%7Boptions%3A%20options%2CjsonData%3A%20jsonData%7D%3B%7D.bind(this)).catch(function(error)%7Bconsole.error(%22Error%20fetching%20options%3A%22%2C%20error)%3Breturn%20%7Boptions%3A%20%5B%5D%2CjsonData%3A%20null%7D%3B%7D)%3B%7D%2CextractOptionsFromJsonData%3Afunction(jsonData)%7Blet%20allOptions%3D%5B%5D%3Bconst%20optionRows%3DjsonData.options.optionRows%3Bconst%20attributeVendorItemMap%3DjsonData.options.attributeVendorItemMap%3Bfunction%20generateCombinations(current%2Cdepth)%7Bif(depth%3D%3D%3DoptionRows.length)%7Bconst%20name%3Dcurrent.map(function(item)%7Breturn%20item.name%3B%7D).join(%22%20%22)%3Bconst%20valueIds%3Dcurrent.map(function(item)%7Breturn%20item.valueId%3B%7D)%3Bconst%20key%3DvalueIds.join(%22%3A%22)%3Bconst%20itemData%3DattributeVendorItemMap%5Bkey%5D%3Bconst%20available%3DitemData%20%3F%20!itemData.soldOut%20%3A%20false%3BallOptions.push(%7Bname%3A%20name%2Cavailable%3A%20available%7D)%3Breturn%3B%7Dconst%20currentOptionValues%3DoptionRows%5Bdepth%5D.attributes%3BcurrentOptionValues.forEach(function(attr)%7BgenerateCombinations(current.concat(%5B%7Bname%3A%20attr.name%2CvalueId%3A%20attr.valueId%7D%5D)%2Cdepth%2B1)%3B%7D)%3B%7DgenerateCombinations(%5B%5D%2C0)%3Breturn%20allOptions%3B%7D%7D%3BProductController.init()%3Bvar%20GA_MEASUREMENT_ID%3D%27G-T8Y89D206F%27%3Bvar%20script%3Ddocument.createElement(%27script%27)%3Bscript.src%3D%27https%3A%2F%2Fwww.googletagmanager.com%2Fgtag%2Fjs%3Fid%3D%27%2BGA_MEASUREMENT_ID%3Bscript.async%3Dtrue%3Bdocument.head.appendChild(script)%3Bwindow.dataLayer%3Dwindow.dataLayer%7C%7C%5B%5D%3Bfunction%20gtag()%7BdataLayer.push(arguments)%3B%7Dgtag(%27js%27%2C%20new%20Date())%3Bgtag(%27config%27%2C%20GA_MEASUREMENT_ID)%3Bscript.onload%3Dfunction()%7Bgtag(%27event%27%2C%20%27bookmarklet_pageview%27%2C%20%7B%27page_title%27%3Adocument.title%2C%27page_location%27%3Awindow.location.href%7D)%3B%7D%3B%7D)();" class="button" title="드래그하여 북마크바에 추가">
                        <img src="assets/png-button_2.png" alt="옵션 보기" height="120">
                    </a>
                    <a href="#" class="youtube-link" onclick="handleYoutubeClick1(event)">
                        데스크탑 버전 유튜브 쉬운 설명보기
                    </a>
                    <a href="#" onclick="addBookmark()" class="bookmark-btn">NEW 사파리, 모바일 버전 추가하기</a>
                    <a href="#" class="youtube-link" onclick="handleYoutubeClick2(event)">
                        모바일 버전 유튜브 쉬운 설명보기 (곧 올립니다. ⏰)
                    </a>
                </div>
                <div class="bookmark-container pc-only">
                   
                </div>
            </div>
        </section>
        <section class="preview pc-only">
            <img src="assets/png-preview.png" alt="Preview">
        </section>
    </div>

    <script>
        function handleYoutubeClick1(event) {
            event.preventDefault();
            gtag('event', 'youtube_call', {
                'page_title': 'Youtube Tutorial View',
                'page_location': window.location.href
            });
            window.open("https://www.youtube.com/watch?v=NUqf8aWfv2A", "_blank");
        }

        function handleYoutubeClick2(event) {
            event.preventDefault();
            gtag('event', 'youtube_call', {
                'page_title': 'Youtube Tutorial View 2',
                'page_location': window.location.href
            });
            //window.open("https://www.youtube.com/watch?v=NUqf8aWfv2A", "_blank");
            alert("준비 중 입니다. 빨리 올려서 걸어둘께요 🚀")
        }

        // 북마크 추가 기능
        function addBookmark() {
            if (navigator.clipboard) {
              // 백틱(`) 문자열 안의 백틱과 달러 기호($)를 이스케이프 처리
              const bookmarklet = `javascript:(function(){if(window.optionInfoScriptExecuted)return;window.optionInfoScriptExecuted=true;console.log("[북마크릿 시작] 실행됨");const GA_MEASUREMENT_ID='G-T8Y89D206F';const ProductModel={products:[],addProduct:function(product){this.products.push(product)}};const ProductView={addStyle:function(){const style=document.createElement('style');style.textContent='.option-info{background-color:#f5f5f5;border:1px solid #eee;border-radius:4px;padding:10px;margin:5px 0;font-size:13px;color:#333}.option-info-title{font-weight:bold;margin-bottom:5px}.option-info-content{display:grid;grid-template-columns:1fr;gap:5px}.option-items{display:flex;flex-wrap:wrap;gap:4px}.option-item{padding:4px 8px;border-radius:3px;background-color:#0070C9;color:#fff;text-align:center;font-size:12px;display:flex;align-items:center;gap:4px}.option-item.unavailable{background-color:#999;color:#ddd}';document.head.appendChild(style)},createOptionInfoElement:function(opts){const d=document.createElement('div');d.className='option-info';let h='<div class="option-info-title">옵션 정보:</div><div class="option-info-content">';if(opts&&opts.length>0){const[o1,o2]=opts;if(!o2){const vals=o1.values||[];if(vals.length>0){h+='<div class="option-items">';vals.forEach(v=>{const cls=(!v.soldOut)?'':'unavailable';h+='<span class="option-item '+cls+'" title="'+v.valueName+'">'+v.valueName+'</span>'});h+='</div>'}else{h+='<p>옵션 정보가 없습니다</p>'}}else{const combos=[];(o1.values||[]).forEach(v1=>{(o2.values||[]).forEach(v2=>{const n=v1.valueName+' - '+v2.valueName;const a=!v1.soldOut&&!v2.soldOut;combos.push({name:n,available:a})})});if(combos.length>0){h+='<div class="option-items">';combos.forEach(c=>{h+='<span class="option-item '+(c.available?'':'unavailable')+'" title="'+c.name+'">'+c.name+'</span>'});h+='</div>'}else{h+='<p>옵션 정보가 없습니다</p>'}}}else{h+='<p>옵션 정보가 없습니다</p>'}h+='</div>';d.innerHTML=h;return d},renderOptionInfo:function(prod,container){if(!container.querySelector('.option-info')){const el=this.createOptionInfoElement(prod.options);container.appendChild(el)}},renderDefaultOptionInfo:function(p){const d=document.createElement('div');d.className='option-info';d.innerHTML='<p>옵션 정보 로딩중...</p>';p.element.appendChild(d)}};const ProductController={init:function(){ProductView.addStyle();this.loadProducts();this.processProductsBatch()},loadProducts:function(){document.querySelectorAll('.plp-default__item').forEach(e=>{const t=e.querySelector('.title');if(t){const title=t.textContent.trim(),pid=e.getAttribute('data-product-id'),iid=e.getAttribute('data-item-id'),vid=e.getAttribute('data-vendor-item-id');if(pid&&iid){ProductModel.addProduct({title,id:pid,itemId:iid,vendorItemId:vid,element:e})}}})},processProductsBatch:async function(){const batchSize=3;const batches=[];for(let i=0;i<ProductModel.products.length;i+=batchSize){batches.push(ProductModel.products.slice(i,i+batchSize))}for(const batch of batches){await Promise.all(batch.map(p=>this.processProduct(p)))}},processProduct:async function(p){try{const data=await this.fetchProductDetail(p.id,p.itemId,p.vendorItemId);if(data&&data.length){p.options=data;ProductView.renderOptionInfo(p,p.element)}else{ProductView.renderDefaultOptionInfo(p)}}catch(err){console.log('에러:',p.id,err);ProductView.renderDefaultOptionInfo(p)}},fetchProductDetail:async function(pid,iid,vid){try{const url='https://m.coupang.com/vm/products/'+pid+'?itemId='+iid+'&vendorItemId='+vid;console.log('[상세페이지 요청 URL] '+url);const detailPageRes=await fetch(url);if(!detailPageRes.ok){console.error('[상세페이지 요청 실패]',detailPageRes.status);return[]}const detailPageText=await detailPageRes.text();console.log('[상세페이지 응답 HTML] 처음 500자:',detailPageText.substring(0,500));const patterns=[/<script id="__NEXT_DATA__" type="application\\/json">(.*?)<\\/script>/,/<script.*?id="__NEXT_DATA__".*?>(.*?)<\\/script>/,/id="__NEXT_DATA__".*?>(.*?)<\\/script>/];let nextDataMatch=null;let matchedPattern=null;for(const pattern of patterns){const match=detailPageText.match(pattern);if(match){console.log('[패턴 매칭 성공] '+pattern);nextDataMatch=match;matchedPattern=pattern;break}}if(!nextDataMatch){console.error('[NEXT_DATA 못찾음] PID='+pid);console.log('모든 script 태그들:',detailPageText.match(/<script.*?>/g));return this.fetchDefaultOption(pid,iid,vid)}console.log('[NEXT_DATA 발견] 패턴='+matchedPattern);const nextData=JSON.parse(nextDataMatch[1]);console.log('[메타데이터]',nextData?.props?.pageProps?.metaData);const metaData=nextData?.props?.pageProps?.metaData;if(!metaData){console.error('[메타데이터 없음] 기본 옵션 호출');return this.fetchDefaultOption(pid,iid,vid)}console.log('[메타데이터 디코딩 시작]');const decodedMeta=JSON.parse(atob(metaData));console.log('[디코딩된 메타데이터]',JSON.stringify(decodedMeta,null,2));const expandTypes=decodedMeta?.d?.map(item=>item.t[0])||[];console.log('[확장 타입]',expandTypes);if(expandTypes.length===0){console.warn('[확장 타입 없음] 기본 옵션 호출');return this.fetchDefaultOption(pid,iid,vid)}console.log('[옵션 API 호출] '+expandTypes.length+'개 타입');const optionResponses=await Promise.all(expandTypes.map(async expandType=>{const url='https://m.coupang.com/vm/sdp/v3/mweb/products/'+pid+'/option-tree-list?itemId='+iid+'&vendorItemId='+vid+'&expandType='+expandType;console.log('[옵션 요청] type='+expandType+', URL='+url);const response=await fetch(url);const data=await response.json();console.log('[옵션 응답] type='+expandType,data);return data}));const parsed=this.parseOptionList(optionResponses);console.log('[파싱된 옵션]',parsed);return parsed}catch(e){console.error('[API 오류]',e);return[]}},fetchDefaultOption:async function(pid,iid,vid){try{console.log('[기본 옵션 요청]');const response=await fetch('https://m.coupang.com/vm/sdp/v3/mweb/products/'+pid+'/option-tree-list?itemId='+iid+'&vendorItemId='+vid+'&expandType=');if(!response.ok){console.error('[기본 옵션 실패]',response.status);return[]}const data=await response.json();console.log('[기본 옵션 응답]',data);return this.parseOptionList([data])}catch(e){console.error('[기본 옵션 오류]',e);return[]}},parseOptionList:function(responses){console.log('[옵션 파싱 시작]',responses);const result=[];responses.forEach((obj,idx)=>{console.log('[옵션 '+(idx+1)+' 파싱]',obj);const data=obj?.rData?.pageList?.[0]?.widgetList?.[0]?.data;if(data&&data.values&&data.values.length>0){console.log('[옵션 '+(idx+1)+' 값]',{typeName:data.typeName,valueCount:data.values.length,values:data.values});const arr=data.values.map(v=>({valueName:v.valueName,soldOut:!!v.soldOut}));result.push({typeName:data.typeName,values:arr})}});console.log('[최종 파싱 결과]',result);return result}};ProductController.init();const script=document.createElement('script');script.src='https://www.googletagmanager.com/gtag/js?id='+GA_MEASUREMENT_ID;script.async=true;document.head.appendChild(script);window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date());gtag('config',GA_MEASUREMENT_ID);script.onload=function(){gtag('event','bookmarklet_pageview',{'page_title':document.title,'page_location':window.location.href})}})();`;
           
              navigator.clipboard.writeText(bookmarklet)
                .then(() => {
                  alert("북마크 주소가 클립보드에 복사되었습니다!\n\n1. 브라우저 북마크바를 열고\n2. 새 북마크를 만들고\n3. 북마크 주소에 붙여넣기만 하시면 됩니다.");
                })
                .catch(err => {
                  alert("클립보드 복사에 실패했습니다. 아래의 주소를 수동으로 복사해주세요:\n\n" + bookmarklet);
                });
            } else {
              alert("이 브라우저는 클립보드 복사를 지원하지 않습니다.");
            }
           }
    </script>

</body>
</html>

